################################################################################
# FreeSWITCH Production ENV Template
# Копируйте этот файл в .env и настройте под ваш deployment
################################################################################

################################################################################
# CORE SETTINGS (обязательно)
################################################################################

# SIP Domain
FS_DOMAIN=apps.linkify.cloud

# External IP/Hostname (публичный IP вашего сервера)
EXTERNAL_SIP_IP=203.0.113.10
EXTERNAL_RTP_IP=203.0.113.10

################################################################################
# USERS - Authenticated SIP Users
# Format: username:password:extension,username2:password2:extension2
################################################################################

# Пример: один пользователь
USERS=exampleuser:examplepass:1001

# Пример: несколько пользователей
# USERS=alice:SecretPass123:1001,bob:SecretPass456:1002,carol:SecretPass789:1003

################################################################################
# GATEWAYS - SIP Providers/Trunks
# Format: name:host:port:username:password:register:transport
################################################################################

# Пример: Provider Gateway (исходящие звонки)
GATEWAYS=provider:fpbx.de:5060:777z9uovpu:4UMtPyXw8Qss:true:udp

# Пример: Multiple Gateways
# GATEWAYS=provider:fpbx.de:5060:777z9uovpu:4UMtPyXw8Qss:true:udp,vapi:vapi.example.com:5060:user:pass:false:udp

# Пример: Gateway без регистрации (для inbound only)
# GATEWAYS=provider:fpbx.de:5060:777z9uovpu:4UMtPyXw8Qss:true:udp,vapi:203.0.113.50:5060:::false:udp

################################################################################
# OUTBOUND ROUTING
# Как маршрутизировать исходящие звонки от users
################################################################################

# Вариант 1: Все звонки через один gateway (простой)
DEFAULT_GATEWAY=provider

# Вариант 2: Маршрутизация по паттернам (продвинутый)
# Format: pattern:gateway:prepend:strip
# OUTBOUND_ROUTES=^00.*:provider1,^0[1-9].*:provider2:+49:0

################################################################################
# INBOUND ROUTING
# Как маршрутизировать входящие звонки к users
################################################################################

# Вариант 1: Все входящие на один extension (простой)
DEFAULT_EXTENSION=1001

# Вариант 2: Маршрутизация по DID (продвинутый)
# Format: DID:extension,DID2:extension2,*:default
# INBOUND_ROUTES=+4930221803986:1001,+4930221803987:1002,*:1001

################################################################################
# CALLER ID SETTINGS (опционально)
################################################################################

# Если нужен фиксированный Caller ID для исходящих
# (будет установлен автоматически для всех исходящих звонков)
# OUTBOUND_CALLER_ID=032221803986

################################################################################
# ACL USERS - IP-based Users (без пароля)
# Format: username:ip_address:extension
# Полезно для trunk connections без authentication
################################################################################

# Пример: VAPI или другой trunk по IP
# ACL_USERS=vapi_trunk:203.0.113.50:9000

################################################################################
# OPTIONAL SETTINGS
################################################################################

# SIP Ports
INTERNAL_SIP_PORT=5060
EXTERNAL_SIP_PORT=5080

# RTP Port Range
RTP_START_PORT=16384
RTP_END_PORT=32768

# Codec Preferences
CODEC_PREFS=PCMU,PCMA,G729,opus
OUTBOUND_CODEC_PREFS=PCMU,PCMA,G729

# Debug (0-9, 0=off, 9=максимально подробно)
SIP_DEBUG=0
SIP_TRACE=no

################################################################################
# ПРИМЕРЫ КОНФИГУРАЦИЙ
################################################################################

# --- ПРИМЕР 1: Простой офис ---
# FS_DOMAIN=office.company.com
# EXTERNAL_SIP_IP=203.0.113.50
# EXTERNAL_RTP_IP=203.0.113.50
# USERS=alice:Pass123:1001,bob:Pass456:1002
# GATEWAYS=provider:sip.provider.com:5060:account:secret:true:udp
# DEFAULT_GATEWAY=provider
# DEFAULT_EXTENSION=1001

# --- ПРИМЕР 2: Provider + VAPI (ваш текущий сценарий) ---
# FS_DOMAIN=apps.linkify.cloud
# EXTERNAL_SIP_IP=your.server.ip
# EXTERNAL_RTP_IP=your.server.ip
# USERS=exampleuser:examplepass:1001
# GATEWAYS=provider:fpbx.de:5060:777z9uovpu:4UMtPyXw8Qss:true:udp,vapi:vapi.host:5060:user:pass:false:udp
# DEFAULT_GATEWAY=provider
# INBOUND_ROUTES=*:1001
# OUTBOUND_ROUTES=.*:vapi  # или используйте DEFAULT_GATEWAY

# --- ПРИМЕР 3: Multi-provider routing ---
# FS_DOMAIN=pbx.company.com
# EXTERNAL_SIP_IP=203.0.113.100
# EXTERNAL_RTP_IP=203.0.113.100
# USERS=user1:Pass1:1001,user2:Pass2:1002
# GATEWAYS=provider_de:sip.de.com:5060:user_de:pass_de:true:udp,provider_us:sip.us.com:5060:user_us:pass_us:true:udp
# OUTBOUND_ROUTES=^\+49.*:provider_de,^\+1.*:provider_us
# INBOUND_ROUTES=+4930111111:1001,+4930222222:1002

################################################################################
# MIGRATION FROM OLD SYSTEM
################################################################################

# Если мигрируете со старой системы (provision_freeswitch.sh):
#
# СТАРАЯ СИСТЕМА:
# SIP_USER=exampleuser
# SIP_PASSWORD=examplepass
# PROVIDER_NAME=provider
# PROVIDER_HOST=fpbx.de
# VAPI_NAME=vapi
# VAPI_HOST=vapi.host
#
# НОВАЯ СИСТЕМА:
# USERS=exampleuser:examplepass:1001
# GATEWAYS=provider:fpbx.de:5060:username:password:true:udp,vapi:vapi.host:5060:user:pass:false:udp
# DEFAULT_GATEWAY=provider
# DEFAULT_EXTENSION=1001
#
# Основные изменения:
# 1. USERS теперь в формате username:password:extension (можно несколько через запятую)
# 2. GATEWAYS объединяет provider и vapi в одну переменную (можно несколько)
# 3. Routing настраивается через DEFAULT_GATEWAY или OUTBOUND_ROUTES/INBOUND_ROUTES

################################################################################
